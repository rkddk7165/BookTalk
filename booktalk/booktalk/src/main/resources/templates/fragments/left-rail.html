<!-- src/main/resources/templates/fragments/left-rail.html -->
<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<body>
<!-- 사용: th:replace="~{fragments/left-rail :: leftRail}" -->
<div th:fragment="leftRail">
    <style>
        :root{
            --rail-width: 260px;
            --rail-gap: 40px;          /* 중앙 컨테이너와의 간격 */
            --navbar-height: 74px;     /* 사이트 네비 높이에 맞춰 조정 */
            --container-max: 1180px;   /* .wrap 최대폭 */
        }
        .left-rail{
            position: fixed;
            top: var(--navbar-height);
            left: calc(50% - min(var(--container-max), 92vw)/2 - var(--rail-width) - var(--rail-gap));
            width: var(--rail-width);
            z-index: 50;
            display: none;              /* 큰 화면에서만 */
        }
        @media (min-width: 1280px){ .left-rail{ display:block; } }

        .rail-stack{ display:flex; flex-direction:column; gap:12px; }

        .lr-panel{
            background:#fff; border:1px solid #e2e5ec; border-radius:12px;
            box-shadow:0 6px 16px rgba(16,24,40,.06); overflow:hidden;
        }
        .lr-head{ display:flex; align-items:center; gap:8px; padding:10px 12px;
            background:#f7f9ff; border-bottom:1px solid #e8ebf3; font-weight:800; color:#233; font-size:14px; }
        .lr-list{ padding:8px 10px; }

        .lr-item{ display:flex; gap:10px; align-items:center; padding:8px 6px;
            border-radius:8px; text-decoration:none; color:#222; }
        .lr-item:hover{ background:#f5f7fb; }

        .dot{ width:8px; height:8px; border-radius:50%; background:#4978ff; flex:0 0 auto; }
        .it-title{ font-size:13px; font-weight:700; color:#111827; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .it-meta{ font-size:12px; color:#7a7f8a; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

        .rank-badge{ display:inline-flex; align-items:center; justify-content:center;
            width:20px; height:20px; border-radius:6px; background:#eef3ff; color:#4068ff; font-size:12px; font-weight:800; flex:0 0 auto; }
    </style>

    <aside class="left-rail" aria-label="왼쪽 레일">
        <div class="rail-stack">

            <!-- Top Writers (있을 때만) -->
            <section class="lr-panel" th:if="${topWriters != null}">
                <div class="lr-head">Top Writers</div>
                <div class="lr-list">
                    <a class="lr-item" th:each="tw, iStat : ${topWriters}" th:href="@{|/users/${tw.userId}|}">
                        <span class="rank-badge" th:text="${iStat.index + 1}">1</span>
                        <div style="min-width:0;">
                            <div class="it-title" th:text="${tw.nickname ?: '익명'}">닉네임</div>
                            <div class="it-meta" th:text="|게시글 ${tw.postCount}개|">게시글 0개</div>
                        </div>
                    </a>
                    <div class="it-meta" th:if="${#lists.isEmpty(topWriters)}" style="padding:8px 6px;">아직 집계할 데이터가 없습니다.</div>
                </div>
            </section>

            <!-- 최근 생성 5 -->
            <section class="lr-panel">
                <div class="lr-head">최근 생성된 게시판</div>
                <div class="lr-list">
                    <a class="lr-item" th:each="b : ${recentBoards}" th:href="@{|/boards/book-discussion/${b.boardId}|}">
                        <span class="dot"></span>
                        <div style="min-width:0;">
                            <div class="it-title" th:text="${b.title}">제목</div>
                            <div class="it-meta" th:text="${b.author}">저자</div>
                        </div>
                    </a>
                    <div class="it-meta" th:if="${#lists.isEmpty(recentBoards)}" style="padding:8px 6px;">데이터가 없습니다.</div>
                </div>
            </section>

            <!-- 활발한 3 -->
            <section class="lr-panel">
                <div class="lr-head">가장 활발한 토론</div>
                <div class="lr-list">
                    <a class="lr-item" th:each="b, idx : ${hotBoards}" th:href="@{|/boards/book-discussion/${b.boardId}|}">
                        <span class="rank-badge" th:text="${idx.index + 1}">1</span>
                        <div style="min-width:0;">
                            <div class="it-title" th:text="${b.title}">제목</div>
                            <div class="it-meta">
                                <span th:text="|게시글 ${b.postCount}개|">게시글 0개</span>
                                <span th:if="${b.author}" th:text="| · ${b.author}|"> · 저자</span>
                            </div>
                        </div>
                    </a>
                    <div class="it-meta" th:if="${#lists.isEmpty(hotBoards)}" style="padding:8px 6px;">데이터가 없습니다.</div>
                </div>
            </section>

        </div>
    </aside>
</div>
</body>
</html>
